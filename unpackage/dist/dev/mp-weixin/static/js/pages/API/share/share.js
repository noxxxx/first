global.webpackJsonp([54],{129:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("view",[a("page-head",{attrs:{title:e.title,mpcomid:"0"}}),e._v(" "),a("view",{staticClass:"page-body"},[a("view",{staticClass:"page-section-title"},[e._v("分享内容")]),e._v(" "),a("view",{staticClass:"page-section"},[a("view",{staticClass:"textarea-wrp"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.shareText,expression:"shareText"}],staticClass:"textarea",attrs:{eventid:"0"},domProps:{value:e.shareText},on:{input:function(t){t.target.composing||(e.shareText=t.target.value)}}})])]),e._v(" "),a("view",{staticClass:"page-section-title"},[e._v("分享图片：")]),e._v(" "),a("view",{staticClass:"page-section"},[a("view",{staticClass:"uni-uploader-body"},[e.image?e._e():a("view",{staticClass:"uni-uploader__input-box",attrs:{eventid:"1"},on:{tap:e.chooseImage}}),e._v(" "),e.image?a("image",{staticClass:"uni-uploader__img",attrs:{src:e.image}}):e._e()])]),e._v(" "),a("view",{staticClass:"btn-area"},[a("button",{attrs:{type:"primary","open-type":"share"}},[e._v("分享")])],1)])],1)};s._withStripped=!0;var n={render:s,staticRenderFns:[]};t.a=n},204:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(1)),n=o(a(35));function o(e){return e&&e.__esModule?e:{default:e}}a(0).default;new s.default(n.default).$mount(),t.default={config:{navigationBarTitleText:"分享"}}},289:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(a(4)),n=o(a(3));function o(e){return e&&e.__esModule?e:{default:e}}var i=a(0).default;t.default={data:function(){return{title:"share",shareText:"uni-app可以同时发布成原生App、微信小程序，邀请你一起体验！",href:"https://uniapp.dcloud.io",image:"",shareType:1,providerList:[]}},onShareAppMessage:function(){return{title:this.shareText?this.shareText:"欢迎体验uni-app",path:"/pages/component/component",imageUrl:this.image?this.image:"https://img-cdn-qiniu.dcloud.net.cn/uniapp/app/share-logo@3.png"}},onUnload:function(){this.shareText="uni-app可以同时发布成原生App、微信小程序，邀请你一起体验！",this.href="https://uniapp.dcloud.io",this.image=""},onLoad:function(){var e=this;i.getProvider({service:"share",success:function(t){console.log("success",t);for(var a=[],s=0;s<t.provider.length;s++)switch(t.provider[s]){case"weixin":a.push({name:"分享到微信好友",id:"weixin",sort:0}),a.push({name:"分享到微信朋友圈",id:"weixin",type:"WXSenceTimeline",sort:1});break;case"sinaweibo":a.push({name:"分享到新浪微博",id:"sinaweibo",sort:2});break;case"qq":a.push({name:"分享到QQ",id:"qq",sort:3})}e.providerList=a.sort(function(e,t){return e.sort-t.sort})},fail:function(e){console.log("获取登录通道失败",e),i.showModal({content:"获取登录通道失败",showCancel:!1})}})},methods:{share:function(e){var t,a=this;return(t=s.default.mark(function t(){var n;return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("分享通道:"+e.id+"； 分享类型:"+a.shareType),a.shareText||1!==a.shareType&&0!==a.shareType){t.next=4;break}return i.showModal({content:"分享内容不能为空",showCancel:!1}),t.abrupt("return");case 4:if(a.image||2!==a.shareType&&0!==a.shareType){t.next=7;break}return i.showModal({content:"分享图片不能为空",showCancel:!1}),t.abrupt("return");case 7:n={provider:e.id,scene:e.type&&"WXSenceTimeline"===e.type?"WXSenceTimeline":"WXSceneSession",type:a.shareType,success:function(e){console.log("success",e),i.showModal({content:"分享成功",showCancel:!1})},fail:function(e){console.log("fail",e),i.showModal({content:e.errMsg,showCancel:!1})},complete:function(){console.log("分享操作结束!")}},t.t0=a.shareType,t.next=0===t.t0?11:1===t.t0?16:2===t.t0?18:5===t.t0?20:24;break;case 11:return n.summary=a.shareText,n.imageUrl=a.image,n.title="欢迎体验uniapp",n.href="http://uniapp.dcloud.io",t.abrupt("break",25);case 16:return n.summary=a.shareText,t.abrupt("break",25);case 18:return n.imageUrl=a.image,t.abrupt("break",25);case 20:return n.imageUrl=a.image?a.image:"https://img-cdn-qiniu.dcloud.net.cn/uniapp/app/share-logo@3.png",n.title="欢迎体验uniapp",n.miniProgram={id:"gh_33446d7f7a26",path:"/pages/component/component",webUrl:"http://uniapp.dcloud.io",type:0},t.abrupt("break",25);case 24:return t.abrupt("break",25);case 25:if(0!==n.type||"iOS"!==plus.os.name){t.next=29;break}return t.next=28,a.compress();case 28:n.imageUrl=t.sent;case 29:1===n.type&&"qq"===n.provider&&(n.href="http://uniapp.dcloud.io",n.title="欢迎体验uniapp"),i.share(n);case 31:case"end":return t.stop()}},t,a)}),function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function s(n,o){try{var i=e[n](o),r=i.value}catch(e){return void a(e)}if(!i.done)return Promise.resolve(r).then(function(e){s("next",e)},function(e){s("throw",e)});t(r)}("next")})})()},radioChange:function(e){console.log("type:"+e.detail.value),this.shareType=parseInt(e.detail.value)},chooseImage:function(){var e=this;i.chooseImage({count:1,sourceType:["album","camera"],sizeType:["compressed","original"],success:function(t){e.image=t.tempFilePaths[0]}})},compress:function(){console.log("开始压缩");var e=this.image;return new Promise(function(t){var a=plus.io.convertAbsoluteFileSystem(e.replace("file://",""));console.log("after"+a),plus.io.resolveLocalFileSystemURL(a,function(a){a.file(function(a){console.log("getFile:"+JSON.stringify(a)),a.size>20480&&plus.zip.compressImage({src:e,dst:e.replace(".jpg","2222.jpg").replace(".JPG","2222.JPG"),width:"10%",height:"10%",quality:1,overwrite:!0},function(a){console.log("success zip****"+a.size);var s=e.replace(".jpg","2222.jpg").replace(".JPG","2222.JPG");t(s)},function(e){i.showModal({content:"分享图片太大,需要请重新选择图片!",showCancel:!1})})})},function(e){console.log("Resolve file URL failed: "+e.message),i.showModal({content:"分享图片太大,需要请重新选择图片!",showCancel:!1})})})}},components:{pageHead:n.default}}},35:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(289),n=a.n(s),o=a(129),i=!1;var r=function(e){i||a(381)},c=a(2)(n.a,o.a,r,null,null);c.options.__file="Users/sac/Documents/workspace/Hbuilder/hbuilderx/first/pages/API/share/share.vue",c.esModule&&Object.keys(c.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),c.options.functional&&console.error("[vue-loader] share.vue: functional components are not supported with templates, they should use render functions."),t.default=c.exports},381:function(e,t){}},[204]);
//# sourceMappingURL=../../../../../.sourcemap/pages/API/share/share.js.map